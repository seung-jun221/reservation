<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>설명회 참석 체크인 - i.study</title>

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- CSS -->
    <link rel="stylesheet" href="assets/css/checkin.css?v=20250121" />

    <!-- Favicon -->
    <link rel="icon" href="data:," />
  </head>
  <body>
    <!-- 헤더 -->
    <header class="header">
      <div class="header-content">
        <div class="header-left">
          <h1 class="header-title">설명회 참석 체크인</h1>
          <p class="header-subtitle" id="seminarTitle">
            설명회 정보를 불러오는 중...
          </p>
        </div>
      </div>
    </header>

    <main class="container">
      <!-- STEP 1: 전화번호 입력 -->
      <section class="section-card" id="phoneStep">
        <div class="step-indicator">
          <span class="step active">1</span>
          <span class="step-line"></span>
          <span class="step">2</span>
        </div>

        <h2 class="section-title">참석 확인</h2>
        <p class="section-desc">학부모님 전화번호 뒷 4자리를 입력해주세요</p>

        <form id="phoneForm" class="checkin-form">
          <div class="phone-input-group">
            <span class="phone-prefix">010-****-</span>
            <input
              type="tel"
              id="phoneLast4"
              class="phone-input"
              placeholder="0000"
              maxlength="4"
              pattern="[0-9]{4}"
              inputmode="numeric"
              required
              autofocus
            />
          </div>

          <button type="submit" class="btn btn-primary btn-large">확인</button>
        </form>

        <div class="help-text">
          <p>예약 시 등록한 전화번호를 입력해주세요</p>
        </div>
      </section>

      <!-- STEP 1-2: 중복 확인 (필요시) -->
      <section class="section-card hidden" id="duplicateStep">
        <div class="step-indicator">
          <span class="step active">1</span>
          <span class="step-line"></span>
          <span class="step">2</span>
        </div>

        <h2 class="section-title">추가 확인이 필요합니다</h2>
        <p class="section-desc">전화번호 중간 4자리를 추가로 입력해주세요</p>

        <form id="duplicateForm" class="checkin-form">
          <div class="phone-input-group">
            <span class="phone-prefix">010-</span>
            <input
              type="tel"
              id="phoneMiddle4"
              class="phone-input middle"
              placeholder="0000"
              maxlength="4"
              pattern="[0-9]{4}"
              inputmode="numeric"
              required
              autofocus
            />
            <span class="phone-suffix" id="phoneSuffix">-0000</span>
          </div>

          <button type="submit" class="btn btn-primary btn-large">확인</button>
        </form>

        <button class="btn btn-secondary" onclick="backToPhoneStep()">
          뒤로 가기
        </button>
      </section>

      <!-- STEP 2: 체크인 완료 (개선된 디자인) -->
      <section class="section-card hidden" id="completeStep">
        <div class="step-indicator">
          <span class="step completed">✓</span>
          <span class="step-line active"></span>
          <span class="step active">2</span>
        </div>

        <!-- 참석 확인 메시지 -->
        <div class="complete-header">
          <h2 class="complete-title">참석이 확인되었습니다</h2>
          <p class="attendee-name" id="attendeeName">홍길동 학부모님</p>
          <p class="brand-message">"아이의 생각하는 힘을 키워갑니다"</p>
          <p class="brand-name">수리탐구 i.study</p>
        </div>

        <!-- 컨설팅 혜택 안내 -->
        <div class="consulting-benefit">
          <div class="benefit-badge">설명회 참석자 특별 혜택</div>

          <h3 class="benefit-title">
            오늘 하루만 제공되는<br />
            1:1 맞춤 컨설팅 우선 예약
          </h3>

          <ul class="benefit-features">
            <li>참석자 전용 시간대 선택</li>
            <li>대표이사와의 개별 컨설팅</li>
            <li>개인별 맞춤 학습 로드맵</li>
          </ul>

          <div class="timer-container">
            <span class="timer-label">남은 시간</span>
            <span class="timer-value" id="benefitTimer">23:59:00</span>
          </div>

          <button
            class="btn btn-primary btn-large btn-consulting"
            onclick="goToConsulting()"
          >
            지금 컨설팅 예약하기
          </button>
        </div>

        <!-- 나중에 예약 옵션 -->
        <div class="later-section">
          <p class="later-title">나중에 예약하시겠어요?</p>

          <button class="btn btn-outline btn-copy" onclick="copyLink()">
            예약 링크 복사
          </button>

          <div class="copy-guide">
            <p>복사 후 카카오톡 '나와의 채팅'에<br />저장해두세요</p>
          </div>
        </div>

        <!-- 홈으로 -->
        <div class="footer-action">
          <button class="btn btn-text" onclick="goHome()">
            홈으로 돌아가기
          </button>
        </div>
      </section>

      <!-- 에러 상태 -->
      <section class="section-card hidden" id="errorStep">
        <div class="error-message">
          <div class="error-icon">⚠️</div>
          <h2 class="error-title">예약을 찾을 수 없습니다</h2>
          <p class="error-desc">
            입력하신 전화번호로 예약된 내역이 없습니다.<br />
            예약 시 등록한 번호를 다시 확인해주세요.
          </p>
        </div>

        <button class="btn btn-primary" onclick="retryCheckIn()">
          다시 시도
        </button>

        <div class="help-link">
          <p>학원 상담실로 문의해주세요</p>
        </div>
      </section>

      <!-- 로딩 상태 -->
      <section class="section-card hidden" id="loadingStep">
        <div class="loading-state">
          <div class="spinner"></div>
          <p>확인 중입니다...</p>
        </div>
      </section>
    </main>

    <!-- 로딩 오버레이 -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none">
      <div class="loading-content">
        <div class="spinner"></div>
        <p>처리 중...</p>
      </div>
    </div>

    <!-- 토스트 메시지 -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- JavaScript -->
    <script src="assets/js/checkin.js?v=20250121"></script>
  </body>
</html>
